diff --git a/viewer/apiSessions.js b/viewer/apiSessions.js
index 367ef7d9..c869ddc9 100644
--- a/viewer/apiSessions.js
+++ b/viewer/apiSessions.js
@@ -1124,7 +1124,7 @@ module.exports = (Config, Db, internals, ViewerUtils) => {
 
       const fields = session.fields;
 
-      if (maxPackets && fields.packetPos.length > maxPackets) {
+      if (maxPackets && fields.packetPos && fields.packetPos.length > maxPackets) {
         fields.packetPos.length = maxPackets;
       }
 
@@ -1144,11 +1144,16 @@ module.exports = (Config, Db, internals, ViewerUtils) => {
         }
       }
 
-      for (i = 0, ilen = fields.packetPos.length; i < ilen; i++) {
-        if (fields.packetPos[i] < 0) {
-          outstanding++;
-          Db.fileIdToFile(fields.node, -1 * fields.packetPos[i], fileReadyCb);
+      if (fields.packetPos) {
+        for (i = 0, ilen = fields.packetPos.length; i < ilen; i++) {
+          if (fields.packetPos[i] < 0) {
+            outstanding++;
+            Db.fileIdToFile(fields.node, -1 * fields.packetPos[i], fileReadyCb);
+          }
         }
+      } else {
+        // no PCAP backing the session
+        readyToProcess();
       }
 
       function readyToProcess () {
